---
title: KAPE
summary: tool that parses and extracts Windows forensics artifacts


# Optional external URL for project (replaces project detail page).
external_link: ''

reading_time: false  # Show estimated reading time?
share: false  # Show social sharing links?
profile: false  # Show author profile?
comments: false  # Show comments?
---

## Introduction to KAPE
As reported on task 2 of the room: 

> *Kroll Artifact Parser and Extractor* (KAPE) parses and extracts Windows forensics artifacts. It is a tool that can significantly reduce the time needed to respond to an incident by providing forensic artifacts from a live system or a storage device much earlier than the imaging process completes. 
> 
> KAPE serves two primary purposes, 1) collect files and 2) process the collected files as per the provided options. For achieving these purposes, KAPE uses the concept of targets and modules. Targets can be defined as the forensic artifacts that need to be collected. Modules are programs that process the collected artifacts and extract information from them. We will learn about them in the upcoming tasks.

Task 3,4,5,6 explain how the tool works, terminology and a quick example of how to setup. 

Let's focus on task 7  with the *Hands-on Challenge*.

## Hands-on Challenge
The scenario is the following:
> Organization X has an Acceptable Use Policy for their Portable Devices, including Laptops. This policy forbids users from connecting removable or Network drives, installing software from unknown locations, and connecting to unknown networks. It looks like one of the users has violated this policy. Can you help Organization X find out if the user violated the Acceptable Use Policy on their device? 

### Setup the tool
Let's start by executing *gkape.exe* for using the tool with the GUI. Once the application has started we can fill the required parameters. Specifically we have to select the Target options and the Model options.
Starting from the target we select:

1. Target source: the path to were we want to perform the forensics (e.g C:\)
2. Target destination: the path were the  files will be copied (e.g ~Desktop\kape)
3. Targets: select the various collected artifacts. We are interested in connections of removable or network drives, connection to networks and installation of software as stated in the policy above. 
So we can search and add the artifacts related to the USB logs (since we need that info for one question) and KapeTriage which collects all the data that have to do with Registry, System files and more.

On Module options: 
1. Module source: tipically the same path of the target destination (leave blank)
2. Module destination: path to were the output is saved.e.g ~Desktop\output)
3. Modules: select the various module to use for processing the targets. Here we can select the Eric Zimmerman provided parsers.

We are now ready to click execute and let Kape do the magic!

![kape1](https://user-images.githubusercontent.com/70201797/178516428-3a543e39-ea6f-4f0a-bccb-d1b93078e584.png)

### Question 1
We need to find the Serial Number of the other USB Device that was connected to the device. To discover it we search in the output folder generated by Kape. Inside the *Registry* directory we can find several *.csv* files. The one we are looking for is called *DeviceClasses.csv* which contains the devices that were connected to the machine. We can identify the USB by looking at the type column and searching the 2 USB devices. 
<details>
  <summary>The serial number of the USB is the following:</summary>
  <p>
	1C6F654E59A3B0C179D366AE
  </p>
</details>


### Question 2
We need to find  the drive letter and path of the directory from where 7zip, Google Chrome and Mozilla Firefox  were installed giving that they come from a network drive location.

Navigate to 
*Output/FileFloderAccess/automaticDestination.csv*
to analyze all the file that has been accessed and view the path from which programs were installed.

<details>
  <summary>Answer:</summary>
  <p>
	Z:\Setups
  </p>
</details>

### Question 3
The next question asks us to find the execution date and time of CHROMESETUP.EXE. To answer we can navigate to *Registry/RecentApps.csv* where all recent applications are registered.

<details>
  <summary>Answer:</summary>
  <p>
	11/25/2021 03:33
  </p>
</details>

### Question 4
What search query was run on the system?
Always inside the Registry folder we can look at *WordWheelQuery.csv* to know which queries were run on the system.
<details>
  <summary>Answer:</summary>
  <p>
	RunWallpaperSetup.cmd
  </p>
</details>

### Question 5
Next question is about when was the network named Network 3 First connected. We can find this information inside *Registry/KnownNetworks.csv*
from there we can see Network 3 first and last connection time. 
<details>
  <summary>Answer:</summary>
  <p>
	11/30/2021 15:44
  </p>
</details>

### Question 6
The last question is what removable drive was KAPE copied from. As before we can identify the path inside
*FileFloderAccess/AutomaticDestination.csv*

<details>
  <summary>Answer:</summary>
  <p>
	E:
  </p>
</details>

**Hurray!**

[Heartstone back to home](https://matteogreek.github.io/)
