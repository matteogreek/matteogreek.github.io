<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: October 18, 2025 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.993e2c58b7497c3aa6d7461bc011014e.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Matteo Greco"><meta name=description content="tool that parses and extracts Windows forensics artifacts"><link rel=alternate hreflang=en-us href=https://matteogreek.github.io/_writeups/thm/kape_writeup/><link rel=canonical href=https://matteogreek.github.io/_writeups/thm/kape_writeup/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://matteogreek.github.io/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_512x512_fill_lanczos_center_3.png"><meta property="og:site_name" content="Matteo Greco"><meta property="og:url" content="https://matteogreek.github.io/_writeups/thm/kape_writeup/"><meta property="og:title" content="KAPE | Matteo Greco"><meta property="og:description" content="tool that parses and extracts Windows forensics artifacts"><meta property="og:image" content="https://matteogreek.github.io/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><title>KAPE | Matteo Greco</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=05420ea288ffff8b89eeb5636597247b><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Matteo Greco</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Matteo Greco</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#experience><span>Experience</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/uploads/resume.pdf><span>CV</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>KAPE</h1><div class=article-metadata><span class=article-date>Jan 1, 0001</span></div></div><div class=article-container><div class=article-style><h2 id=introduction-to-kape>Introduction to KAPE</h2><p>As reported on task 2 of the room:</p><blockquote><p><em>Kroll Artifact Parser and Extractor</em> (KAPE) parses and extracts Windows forensics artifacts. It is a tool that can significantly reduce the time needed to respond to an incident by providing forensic artifacts from a live system or a storage device much earlier than the imaging process completes.</p><p>KAPE serves two primary purposes, 1) collect files and 2) process the collected files as per the provided options. For achieving these purposes, KAPE uses the concept of targets and modules. Targets can be defined as the forensic artifacts that need to be collected. Modules are programs that process the collected artifacts and extract information from them. We will learn about them in the upcoming tasks.</p></blockquote><p>Task 3,4,5,6 explain how the tool works, terminology and a quick example of how to setup.</p><p>Let&rsquo;s focus on task 7 with the <em>Hands-on Challenge</em>.</p><h2 id=hands-on-challenge>Hands-on Challenge</h2><p>The scenario is the following:</p><blockquote><p>Organization X has an Acceptable Use Policy for their Portable Devices, including Laptops. This policy forbids users from connecting removable or Network drives, installing software from unknown locations, and connecting to unknown networks. It looks like one of the users has violated this policy. Can you help Organization X find out if the user violated the Acceptable Use Policy on their device?</p></blockquote><h3 id=setup-the-tool>Setup the tool</h3><p>Let&rsquo;s start by executing <em>gkape.exe</em> for using the tool with the GUI. Once the application has started we can fill the required parameters. Specifically we have to select the Target options and the Model options.
Starting from the target we select:</p><ol><li>Target source: the path to were we want to perform the forensics (e.g C:)</li><li>Target destination: the path were the files will be copied (e.g ~Desktop\kape)</li><li>Targets: select the various collected artifacts. We are interested in connections of removable or network drives, connection to networks and installation of software as stated in the policy above.
So we can search and add the artifacts related to the USB logs (since we need that info for one question) and KapeTriage which collects all the data that have to do with Registry, System files and more.</li></ol><p>On Module options:</p><ol><li>Module source: tipically the same path of the target destination (leave blank)</li><li>Module destination: path to were the output is saved.e.g ~Desktop\output)</li><li>Modules: select the various module to use for processing the targets. Here we can select the Eric Zimmerman provided parsers.</li></ol><p>We are now ready to click execute and let Kape do the magic!</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://user-images.githubusercontent.com/70201797/178516428-3a543e39-ea6f-4f0a-bccb-d1b93078e584.png alt=kape1 loading=lazy data-zoomable></div></div></figure></p><h3 id=question-1>Question 1</h3><p>We need to find the Serial Number of the other USB Device that was connected to the device. To discover it we search in the output folder generated by Kape. Inside the <em>Registry</em> directory we can find several <em>.csv</em> files. The one we are looking for is called <em>DeviceClasses.csv</em> which contains the devices that were connected to the machine. We can identify the USB by looking at the type column and searching the 2 USB devices.</p><details><summary>The serial number of the USB is the following:</summary><p>1C6F654E59A3B0C179D366AE</p></details><h3 id=question-2>Question 2</h3><p>We need to find the drive letter and path of the directory from where 7zip, Google Chrome and Mozilla Firefox were installed giving that they come from a network drive location.</p><p>Navigate to
<em>Output/FileFloderAccess/automaticDestination.csv</em>
to analyze all the file that has been accessed and view the path from which programs were installed.</p><details><summary>Answer:</summary><p>Z:\Setups</p></details><h3 id=question-3>Question 3</h3><p>The next question asks us to find the execution date and time of CHROMESETUP.EXE. To answer we can navigate to <em>Registry/RecentApps.csv</em> where all recent applications are registered.</p><details><summary>Answer:</summary><p>11/25/2021 03:33</p></details><h3 id=question-4>Question 4</h3><p>What search query was run on the system?
Always inside the Registry folder we can look at <em>WordWheelQuery.csv</em> to know which queries were run on the system.</p><details><summary>Answer:</summary><p>RunWallpaperSetup.cmd</p></details><h3 id=question-5>Question 5</h3><p>Next question is about when was the network named Network 3 First connected. We can find this information inside <em>Registry/KnownNetworks.csv</em>
from there we can see Network 3 first and last connection time.</p><details><summary>Answer:</summary><p>11/30/2021 15:44</p></details><h3 id=question-6>Question 6</h3><p>The last question is what removable drive was KAPE copied from. As before we can identify the path inside
<em>FileFloderAccess/AutomaticDestination.csv</em></p><details><summary>Answer:</summary><p>E:</p></details><p><strong>Hurray!</strong></p><p><a href=https://matteogreek.github.io/ target=_self>Heartstone back home</a></p></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> â€” the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.1d4346c6f7d46c340dc0a9058dd85c13.js></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.c84202fca2a6efbbecbaf0e8358c1d51.js></script></body></html>