<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: August 21, 2023 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.993e2c58b7497c3aa6d7461bc011014e.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Matteo Greco"><meta name=description content="Summary This exercise is about a suspicious Chrome extension named &ldquo;ChatGPT for Google. The alert was triggered due to the suspicious addition of the extension to the browser, indicating a potential security threat."><link rel=alternate hreflang=en-us href=https://matteogreek.github.io/writeups/letsdefend/soc202-fakegpt-malicious-chrome-extension/><link rel=canonical href=https://matteogreek.github.io/writeups/letsdefend/soc202-fakegpt-malicious-chrome-extension/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://matteogreek.github.io/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_512x512_fill_lanczos_center_3.png"><meta property="og:site_name" content="Matteo Greco"><meta property="og:url" content="https://matteogreek.github.io/writeups/letsdefend/soc202-fakegpt-malicious-chrome-extension/"><meta property="og:title" content="Matteo Greco"><meta property="og:description" content="Summary This exercise is about a suspicious Chrome extension named &ldquo;ChatGPT for Google. The alert was triggered due to the suspicious addition of the extension to the browser, indicating a potential security threat."><meta property="og:image" content="https://matteogreek.github.io/media/icon_hua57a06e9c056e3196c06dde0a266966a_404_512x512_fill_lanczos_center_3.png"><meta property="og:locale" content="en-us"><title>Matteo Greco</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=45a2a6d819d87fd236e0a7f09b888ead><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Matteo Greco</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Matteo Greco</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#experience><span>Experience</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class=nav-item><a class=nav-link href=/uploads/resume.pdf><span>CV</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1></h1><div class=article-metadata><span class=article-date>Jan 1, 0001</span></div></div><div class=article-container><div class=article-style><h1 id=summary>Summary</h1><p>This exercise is about a suspicious Chrome extension named &ldquo;ChatGPT for Google. The alert was triggered due to the suspicious addition of the extension to the browser, indicating a potential security threat. The add-on, disguising as a ChatGPT tool, targeted users&rsquo; Facebook profiles. Despite its removal from the Chrome Web Store, many had already installed it, posing concerns about data privacy. Subsequent checks of network activity showed links to harmful websites related to the extension&rsquo;s C2 framework. These links, combined with data from threat intelligence sources, verified the extension&rsquo;s malevolent intent and the significant danger it presented to users.</p><h1 id=alert>Alert</h1><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Severity: High
</span></span><span class=line><span class=cl>Type: Data Leakage
</span></span><span class=line><span class=cl>EventID : 153
</span></span><span class=line><span class=cl>Event Time : May, 29, 2023, 01:01 PM
</span></span><span class=line><span class=cl>Rule : SOC202 - FakeGPT Malicious Chrome Extension
</span></span><span class=line><span class=cl>Level : Security Analyst
</span></span><span class=line><span class=cl>Hostname : Samuel
</span></span><span class=line><span class=cl>IP Address : 172.16.17.173
</span></span><span class=line><span class=cl>File Name : hacfaophiklaeolhnmckojjjjbnappen.crx
</span></span><span class=line><span class=cl>File Path : C:\Users\LetsDefend\Download\hacfaophiklaeolhnmckojjjjbnappen.crx
</span></span><span class=line><span class=cl>File Hash : 7421f9abe5e618a0d517861f4709df53292a5f137053a227bfb4eb8e152a4669
</span></span><span class=line><span class=cl>Command Line : chrome.exe --single-argument C:\Users\LetsDefend\Download\hacfaophiklaeolhnmckojjjjbnappen.crx
</span></span><span class=line><span class=cl>Trigger Reason : Suspicious extension added to the browser.
</span></span><span class=line><span class=cl>Device Action : Allowed
</span></span></code></pre></div><p>From the alert details given, a dubious file has been identified on a system labeled &ldquo;Samuel&rdquo; having an IP address of 172.16.17.173. This alert was activated by the SOC202 rule pertaining to the FakeGPT Malicious Chrome Extension. From the provided data, it seems the command line is trying to access or modify a Chrome extension file (having a .crx extension) via the Google Chrome browser. The device&rsquo;s response is labeled as &ldquo;allowed&rdquo;, suggesting that the device didn&rsquo;t intervene or halt the file&rsquo;s execution.</p><p>The file name of the extension added to the browser is: <strong>hacfaophiklaeolhnmckojjjjbnappen.crx</strong>
The file hash is: <strong>7421f9abe5e618a0d517861f4709df53292a5f137053a227bfb4eb8e152a4669</strong></p><h1 id=analysis>Analysis</h1><p>In the following segment, we&rsquo;ll delve into a comprehensive examination of the flagged malicious extension, utilizing external tools and methods. Moreover, we are going to try to identify the Command and Control (C2) address associated with the malware.</p><h2 id=extension-analysis>Extension Analysis</h2><ul><li>Virustotal: No security vendors and no sandboxes flagged this file as malicious</li><li>MalwareBazaar: No results</li><li>ChromeStats: <a href=https://chrome-stats.com/d/hacfaophiklaeolhnmckojjjjbnappen target=_blank rel=noopener>https://chrome-stats.com/d/hacfaophiklaeolhnmckojjjjbnappen</a>
Using ChromeStats we can find some interesting information. The extension is flagged as malicious and was removed from the Web Store. This is could be a sign that the extension is actually malicious and the alert is a true positive one.</li></ul><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://github.com/matteogreek/matteogreek.github.io/assets/70201797/69054b95-0c81-4312-a4e8-e2c091e66c53 alt="Pasted image 20230819163706" loading=lazy data-zoomable></div></div></figure></p><p>By looking at the Browse History of the affected Host &ldquo;Samuel&rdquo; using the EDR, we can see that he visited the URL: <a href=https://chrome.google.com/webstore/detail/chatgpt-for-google/hacfaophiklaeolhnmckojjjjbnappen target=_blank rel=noopener>https://chrome.google.com/webstore/detail/chatgpt-for-google/hacfaophiklaeolhnmckojjjjbnappen</a> at 2023-05-29 13:01:44. Visiting the URL, resulted in a 404 error message. This finding seems to agree with the previous clue obtained with ChromeStats.</p><h2 id=command-and-control-c2-identification>Command and Control (C2) Identification</h2><p>In this section, we will search for signs of Command and Control (C2) access. Let&rsquo;s start by analyzing the network-related logs gathered from the &ldquo;Samuel&rdquo; Host.</p><p>On the Log Management tab we can filter by Samuel&rsquo;s IP address 172.16.17.173.
Here we find that the source IP made:</p><ul><li>a request to the IP 52.76.101.124 on port 80 on May, 29, 2023, 01:02 PM. By analyzing the raw log entry we can see that the Hostname linked to the destination IP is www.chatgptforgoogle.pro.</li><li>Another request was made to IP 172.217.17.142 on port 80 on May, 29, 2023, 01:03 PM (1 min after the previous one). By analyzing the raw log entry we can see that the Hostname linked to the destination IP is chrome.google.com</li><li>Another request was made to IP 18.140.6.45 on port 80 on May, 29, 2023, 01:03 PM (1 min after the previous one). By analyzing the raw log entry we can see that the Hostname linked to the destination IP is www.chatgptgoogle.org</li><li>A DNS Query was made:<ul><li>QueryResult: ::ffff:104.21.63.166;::ffff:172.67.147.243;</li><li>QueryName: version.chatgpt4google.workers.dev</li></ul></li></ul><p>Further investigation of the domain <a href=https://www.chatgptforgoogle.pro target=_blank rel=noopener>www.chatgptforgoogle.pro</a> on threat intelligence platforms, such as VirusTotal, confirms its malicious nature.</p><h1 id=conclusion>Conclusion</h1><p>The alert was a true positive and the findings confirm that the Chrome extension is malicious.
Furthermore the Host accessed the malicious C2 address and so it was isolated from the network.</p><p><a href=https://matteogreek.github.io/ target=_blank rel=noopener>Heartstone back home</a></p></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fmatteogreek.github.io%2Fwriteups%2Fletsdefend%2Fsoc202-fakegpt-malicious-chrome-extension%2F&amp;text=" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fmatteogreek.github.io%2Fwriteups%2Fletsdefend%2Fsoc202-fakegpt-malicious-chrome-extension%2F&amp;t=" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=&amp;body=https%3A%2F%2Fmatteogreek.github.io%2Fwriteups%2Fletsdefend%2Fsoc202-fakegpt-malicious-chrome-extension%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fmatteogreek.github.io%2Fwriteups%2Fletsdefend%2Fsoc202-fakegpt-malicious-chrome-extension%2F&amp;title=" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=%20https%3A%2F%2Fmatteogreek.github.io%2Fwriteups%2Fletsdefend%2Fsoc202-fakegpt-malicious-chrome-extension%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fmatteogreek.github.io%2Fwriteups%2Fletsdefend%2Fsoc202-fakegpt-malicious-chrome-extension%2F&amp;title=" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://matteogreek.github.io/><img class="avatar mr-3 avatar-circle" src=/authors/admin/avatar_hu5e5208512c9de308d3d84ba82d9fd6ce_94029_270x270_fill_q75_lanczos_center.jpg alt="Matteo Greco"></a><div class=media-body><h5 class=card-title><a href=https://matteogreek.github.io/>Matteo Greco</a></h5><h6 class=card-subtitle>MSc student in Cyber Security</h6><ul class=network-icon aria-hidden=true><li><a href=mailto:matgrec@gmail.com><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/matteogreek target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/matteogreek/ target=_blank rel=noopener><i class="fab fa-linkedin"></i></a></li><li><a href=/uploads/resume.pdf><i class="ai ai-cv"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js></script>
<script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.ead4a376bcf2c4714888c770ea9b0040.js></script></body></html>